import Vclip
from xml.dom import minidom

class Vcontroller:
	def __init__(self,xml):
		self.man = VclipManager(xml)
	def update():
		#todo update self.man, decide how to pass it state information
		pass
	def draw():
		self.man.draw()
		
class VclipManager():
	class GraphNode:
		def __init__(self,xml):
			#TODO if xml is not element node, (i.e. it is document from just loaded xml file) then try and find an appropriate element node
			self.xml = xml
			#considering parsing xml data to native datatypes for slightly improved performance
			pass 
		def getAttribute(prop):
			try: return self.xml.getAttribute(prop)
			except: return ""
		def getNext(state):
			"""
			returns id of next node if transition is to take place, returns -1 otherwise
			"""
			#TODO decide how you want ot handle state information
			pass
	def __init__(self):
		self.active = 1
		pass
	def load(xml):
		"""
		filename is location of graph xml data file.
		graph xml data file will contain information concerning clips
		"""
		self.graphxml = xml
		self.clipxml = minidom.parse(self.graphxml.getAttribute("clipxml")
		#setup transition graph
		self.graphmap = dict()
		for i in utils.xml.getChildren(self.graphxml.,"clip"):
			self.graphmap[i.getAttribute("id")] = GraphNode(i)
		#set up clipmap
		self.clipmap = dict()
		for i in self.clipxml.childNodes:
			if i:	#check if node is right type and check if name is correct
				type = i.getAttribute("type")
				clip = getAttr(Vclip,type)(i)
				self.clipmap[i.getAttribute("name")] = clip
	def draw():
		self.clipmap[self.graphmap[i].getAttribute("name")].draw()
				
class Overlayer:
	def __init__(self):
		pass
	def update():
		pass
	def draw():
		pass
		